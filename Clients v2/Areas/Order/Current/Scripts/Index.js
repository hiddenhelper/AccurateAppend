var id;
var start;
var end;
var dataUrl;
var usageDateRangeWidget;
$(function () {
    var today = moment().add(1, "days");
    var monthAgo = moment(today).add(-14, "days");
    start = $("#start").kendoDatePicker({
        change: startChange,
        value: monthAgo.toDate()
    }).data("kendoDatePicker");
    end = $("#end").kendoDatePicker({
        change: endChange,
        value: today.toDate(),
    }).data("kendoDatePicker");
    renderOrderGrid(dataUrl);
    window.setInterval(function () {
        renderOrderGrid(dataUrl);
    }, 60000);
    $("#grid").find("[data-role=pager]").css({ "margin-bottom": 0 });
    $("#DownloadUsage").click(function () { $("#downloadUsageModal").modal("show"); });
    usageDateRangeWidget = new AccurateAppend.DatePicker.DateRangeWidget("usageDateRangeWidget", new AccurateAppend.DatePicker.DateRangeWidgetSettings([
        AccurateAppend.DatePicker.DateRangeValue.Last24Hours,
        AccurateAppend.DatePicker.DateRangeValue.Last7Days,
        AccurateAppend.DatePicker.DateRangeValue.Last30Days,
        AccurateAppend.DatePicker.DateRangeValue.Last60Days,
        AccurateAppend.DatePicker.DateRangeValue.LastMonth,
        AccurateAppend.DatePicker.DateRangeValue.Custom
    ], AccurateAppend.DatePicker.DateRangeValue.LastMonth, []));
});
var View = (function () {
    function View() {
    }
    return View;
}());
var OrderTypeBatch = "Batch";
var OrderTypePush = "Push";
var OrderTypeClient = "Client";
function startChange() {
    var startDate = start.value();
    var endDate = end.value();
    if (startDate) {
        startDate = new Date(startDate);
        startDate.setDate(startDate.getDate());
        end.min(startDate);
    }
    else if (endDate) {
        start.max(new Date(endDate));
    }
    else {
        endDate = new Date();
        start.max(endDate);
        end.min(endDate);
    }
    renderOrderGrid(dataUrl);
}
function endChange() {
    var endDate = end.value();
    var startDate = start.value();
    if (endDate) {
        endDate = new Date(endDate);
        endDate.setDate(endDate.getDate());
        start.max(endDate);
    }
    else if (startDate) {
        end.min(new Date(startDate));
    }
    else {
        endDate = new Date();
        start.max(endDate);
        end.min(endDate);
    }
    renderOrderGrid(dataUrl);
}
function renderOrderGrid(url) {
    var grid = $("#grid").data("kendoGrid");
    if (grid !== undefined && grid !== null) {
        grid.dataSource.read();
    }
    else {
        $("#grid").kendoGrid({
            dataSource: {
                type: "json",
                transport: {
                    read: function (options) {
                        $.ajax({
                            url: url,
                            dataType: "json",
                            type: "GET",
                            data: {
                                startDate: moment($("#start").val()).utc().format("YYYY-MM-DD"),
                                endDate: moment($("#end").val()).add(1, "days").utc().format("YYYY-MM-DD")
                            },
                            success: function (result) {
                                options.success(result);
                            }
                        });
                    },
                    cache: false
                },
                pageSize: 20,
                schema: {
                    type: "json",
                    data: "Data",
                    total: function (response) {
                        return response.Data.length;
                    }
                },
                change: function () {
                    if (this.data().length <= 0) {
                        $("#no-orders-message").show();
                        $("#grid").hide();
                        $("#dataSecurityDisclaimer").hide();
                        $("#pager").hide();
                    }
                    else {
                        $("#no-orders-message").hide();
                        $("#grid").show();
                        $("#dataSecurityDisclaimer").show();
                        $("#pager").show();
                        $("#warning").hide();
                    }
                }
            },
            scrollable: false,
            filterable: false,
            pageable: {
                pageSize: 10,
                pageSizes: false,
            },
            columns: [
                {
                    field: "Name",
                    title: "List Name/Source",
                    attributes: { style: "text-align: center;" },
                    template: kendo.template($("#grid-description-column-template").html()),
                    media: "(min-width: 450px)"
                },
                {
                    field: "DateSubmitted",
                    title: "Order Date",
                    attributes: { style: "text-align: center;" },
                    width: 200,
                    template: "#= kendo.toString(kendo.parseDate(DateSubmitted, 'MM/dd/yyyy'), 'MM/dd/yyyy') #",
                    media: "(min-width: 450px)"
                },
                {
                    field: "SourceDescription",
                    title: "Submitted Through",
                    attributes: { style: "text-align: center;" },
                    media: "(min-width: 450px)"
                },
                {
                    field: "StatusDescription",
                    title: "Status",
                    width: 200,
                    attributes: { style: "text-align: center; white-space: nowrap" },
                    template: kendo.template($("#grid-status-column-template").html()),
                    media: "(min-width: 450px)"
                },
                {
                    title: "Summary",
                    template: kendo.template($("#responsive-column-template").html()),
                    media: "(max-width: 450px)"
                }
            ]
        });
    }
}
function displayDownloadConfirmation(downloadUrl, customerFileName, slug, status) {
    switch (status) {
        case "Uploading":
            if (slug)
                $("#downloadConfirmation .modal-body p").text("The results for " + customerFileName + " are currently being uploaded to " + slug + ". This file is for reference only and should not be imported into your nation.");
            break;
        case "Complete":
            $("#downloadConfirmation .modal-body p").text("The results for " + customerFileName + " have been uploaded to " + slug + ". This file is for reference only and should not be imported into your nation.");
            break;
    }
    this.id = downloadUrl;
    $("#downloadConfirmation").modal("show");
}
function downloadPushOutputFile() {
    $("#downloadConfirmation").modal("hide");
    history.pushState(null, "Orders", "/Order/Current");
    window.location.replace("" + id);
}
function downloadFile(url) {
    history.pushState(null, "Orders", "/Order/Current");
    window.location.replace(url);
}
function downloadUsage() {
    $("#downloadUsageModal").modal("hide");
    window.location.replace("/Order/DownloadUsage?start=" + moment($("#usageDateRangeWidget_startDate").val()).format("YYYY-MM-DD") + "&end=" + moment($("#usageDateRangeWidget_endDate").val()).format("YYYY-MM-DD"));
}
function displayMessage(type, message) {
    var alert = $("#alert");
    switch (type) {
        case "success":
            alert.addClass("alert").addClass("alert-success");
            alert.text(message);
            alert.show();
            break;
        case "info":
            alert.addClass("alert").addClass("alert-info");
            alert.text(message);
            alert.show();
            break;
        case "warning":
            alert.addClass("alert").addClass("alert-warning");
            alert.text(message);
            alert.show();
            break;
        case "danger":
            alert.addClass("alert").addClass("alert-danger");
            alert.text(message);
            alert.show();
            break;
        default:
            alert.removeClass();
            alert.hide();
            break;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJJbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxJQUFJLEVBQU8sQ0FBQztBQUNaLElBQUksS0FBVSxDQUFDO0FBQ2YsSUFBSSxHQUFRLENBQUM7QUFDYixJQUFJLE9BQVksQ0FBQztBQUNqQixJQUFJLG9CQUF5QixDQUFDO0FBRTlCLENBQUMsQ0FBQztJQUVBLElBQUksS0FBSyxHQUFHLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDcEMsSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUU5QyxLQUFLLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLGVBQWUsQ0FBQztRQUNsQyxNQUFNLEVBQUUsV0FBVztRQUNuQixLQUFLLEVBQUUsUUFBUSxDQUFDLE1BQU0sRUFBRTtLQUN6QixDQUFDLENBQUMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7SUFFM0IsR0FBRyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxlQUFlLENBQUM7UUFDOUIsTUFBTSxFQUFFLFNBQVM7UUFDakIsS0FBSyxFQUFFLEtBQUssQ0FBQyxNQUFNLEVBQUU7S0FDdEIsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0lBRTNCLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUV6QixNQUFNLENBQUMsV0FBVyxDQUFDO1FBQ2YsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzNCLENBQUMsRUFDRCxLQUFLLENBQUMsQ0FBQztJQUVULENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxlQUFlLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUVqRSxDQUFD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QU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMxQixRQUFRLElBQUksRUFBRTtRQUNkLEtBQUssU0FBUztZQUNaLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ2xELEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDcEIsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2IsTUFBTTtRQUNSLEtBQUssTUFBTTtZQUNULEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQy9DLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDcEIsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2IsTUFBTTtRQUNSLEtBQUssU0FBUztZQUNaLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBQ2xELEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDcEIsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2IsTUFBTTtRQUNSLEtBQUssUUFBUTtZQUNYLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1lBQ2pELEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDcEIsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2IsTUFBTTtRQUNSO1lBQ0UsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ3BCLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztZQUNiLE1BQU07S0FDUDtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLi4vLi4vU2NyaXB0cy90eXBpbmdzL2tlbmRvLXVpL2tlbmRvLXVpLmQudHNcIiAvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vLi4vLi4vc2NyaXB0cy90eXBpbmdzL21vbWVudC9tb21lbnQuZC50c1wiIC8+XHJcblxyXG52YXIgaWQ6IGFueTtcclxudmFyIHN0YXJ0OiBhbnk7XHJcbnZhciBlbmQ6IGFueTtcclxudmFyIGRhdGFVcmw6IGFueTtcclxudmFyIHVzYWdlRGF0ZVJhbmdlV2lkZ2V0OiBhbnk7XHJcblxyXG4kKCgpID0+IHtcclxuXHJcbiAgdmFyIHRvZGF5ID0gbW9tZW50KCkuYWRkKDEsIFwiZGF5c1wiKTtcclxuICB2YXIgbW9udGhBZ28gPSBtb21lbnQodG9kYXkpLmFkZCgtMTQsIFwiZGF5c1wiKTtcclxuXHJcbiAgc3RhcnQgPSAkKFwiI3N0YXJ0XCIpLmtlbmRvRGF0ZVBpY2tlcih7XHJcbiAgICBjaGFuZ2U6IHN0YXJ0Q2hhbmdlLFxyXG4gICAgdmFsdWU6IG1vbnRoQWdvLnRvRGF0ZSgpXHJcbiAgfSkuZGF0YShcImtlbmRvRGF0ZVBpY2tlclwiKTtcclxuXHJcbiAgZW5kID0gJChcIiNlbmRcIikua2VuZG9EYXRlUGlja2VyKHtcclxuICAgIGNoYW5nZTogZW5kQ2hhbmdlLFxyXG4gICAgdmFsdWU6IHRvZGF5LnRvRGF0ZSgpLFxyXG4gIH0pLmRhdGEoXCJrZW5kb0RhdGVQaWNrZXJcIik7XHJcblxyXG4gIHJlbmRlck9yZGVyR3JpZChkYXRhVXJsKTtcclxuXHJcbiAgd2luZG93LnNldEludGVydmFsKCgpID0+IHtcclxuICAgICAgcmVuZGVyT3JkZXJHcmlkKGRhdGFVcmwpO1xyXG4gICAgfSxcclxuICAgIDYwMDAwKTtcclxuICAvLyByZW1vdmVzIGV4dHJhIG1hcmdpbiBhcHBlYXJpbmcgYXQgYm90dG9tIG9mIGdyaWRcclxuICAkKFwiI2dyaWRcIikuZmluZChcIltkYXRhLXJvbGU9cGFnZXJdXCIpLmNzcyh7IFwibWFyZ2luLWJvdHRvbVwiOiAwIH0pO1xyXG5cclxuICAkKFwiI0Rvd25sb2FkVXNhZ2VcIikuY2xpY2soKCkgPT4geyAkKFwiI2Rvd25sb2FkVXNhZ2VNb2RhbFwiKS5tb2RhbChcInNob3dcIik7IH0pO1xyXG5cclxuICB1c2FnZURhdGVSYW5nZVdpZGdldCA9IG5ldyBBY2N1cmF0ZUFwcGVuZC5EYXRlUGlja2VyLkRhdGVSYW5nZVdpZGdldChcInVzYWdlRGF0ZVJhbmdlV2lkZ2V0XCIsXHJcbiAgICBuZXcgQWNjdXJhdGVBcHBlbmQuRGF0ZVBpY2tlci5EYXRlUmFuZ2VXaWRnZXRTZXR0aW5ncyhcclxuICAgICAgW1xyXG4gICAgICAgIEFjY3VyYXRlQXBwZW5kLkRhdGVQaWNrZXIuRGF0ZVJhbmdlVmFsdWUuTGFzdDI0SG91cnMsXHJcbiAgICAgICAgQWNjdXJhdGVBcHBlbmQuRGF0ZVBpY2tlci5EYXRlUmFuZ2VWYWx1ZS5MYXN0N0RheXMsXHJcbiAgICAgICAgQWNjdXJhdGVBcHBlbmQuRGF0ZVBpY2tlci5EYXRlUmFuZ2VWYWx1ZS5MYXN0MzBEYXlzLFxyXG4gICAgICAgIEFjY3VyYXRlQXBwZW5kLkRhdGVQaWNrZXIuRGF0ZVJhbmdlVmFsdWUuTGFzdDYwRGF5cyxcclxuICAgICAgICBBY2N1cmF0ZUFwcGVuZC5EYXRlUGlja2VyLkRhdGVSYW5nZVZhbHVlLkxhc3RNb250aCxcclxuICAgICAgICBBY2N1cmF0ZUFwcGVuZC5EYXRlUGlja2VyLkRhdGVSYW5nZVZhbHVlLkN1c3RvbVxyXG4gICAgICBdLFxyXG4gICAgICBBY2N1cmF0ZUFwcGVuZC5EYXRlUGlja2VyLkRhdGVSYW5nZVZhbHVlLkxhc3RNb250aCxcclxuICAgICAgICAgICAgW10pKTtcclxufSk7XHJcblxyXG5jbGFzcyBWaWV3IHtcclxuICBxdWVyeVVybDogc3RyaW5nO1xyXG59XHJcblxyXG5jb25zdCBPcmRlclR5cGVCYXRjaCA9IFwiQmF0Y2hcIjtcclxuY29uc3QgT3JkZXJUeXBlUHVzaCA9IFwiUHVzaFwiO1xyXG5jb25zdCBPcmRlclR5cGVDbGllbnQgPSBcIkNsaWVudFwiO1xyXG5cclxuZnVuY3Rpb24gc3RhcnRDaGFuZ2UoKSB7XHJcbiAgbGV0IHN0YXJ0RGF0ZSA9IHN0YXJ0LnZhbHVlKCk7XHJcbiAgbGV0IGVuZERhdGUgPSBlbmQudmFsdWUoKTtcclxuICBpZiAoc3RhcnREYXRlKSB7XHJcbiAgICBzdGFydERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpO1xyXG4gICAgc3RhcnREYXRlLnNldERhdGUoc3RhcnREYXRlLmdldERhdGUoKSk7XHJcbiAgICBlbmQubWluKHN0YXJ0RGF0ZSk7XHJcbiAgfSBlbHNlIGlmIChlbmREYXRlKSB7XHJcbiAgICBzdGFydC5tYXgobmV3IERhdGUoZW5kRGF0ZSkpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBlbmREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIHN0YXJ0Lm1heChlbmREYXRlKTtcclxuICAgIGVuZC5taW4oZW5kRGF0ZSk7XHJcbiAgfVxyXG4gIHJlbmRlck9yZGVyR3JpZChkYXRhVXJsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5kQ2hhbmdlKCkge1xyXG4gIGxldCBlbmREYXRlID0gZW5kLnZhbHVlKCk7XHJcbiAgY29uc3Qgc3RhcnREYXRlID0gc3RhcnQudmFsdWUoKTtcclxuICBpZiAoZW5kRGF0ZSkge1xyXG4gICAgZW5kRGF0ZSA9IG5ldyBEYXRlKGVuZERhdGUpO1xyXG4gICAgZW5kRGF0ZS5zZXREYXRlKGVuZERhdGUuZ2V0RGF0ZSgpKTtcclxuICAgIHN0YXJ0Lm1heChlbmREYXRlKTtcclxuICB9IGVsc2UgaWYgKHN0YXJ0RGF0ZSkge1xyXG4gICAgZW5kLm1pbihuZXcgRGF0ZShzdGFydERhdGUpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgZW5kRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBzdGFydC5tYXgoZW5kRGF0ZSk7XHJcbiAgICBlbmQubWluKGVuZERhdGUpO1xyXG4gIH1cclxuICByZW5kZXJPcmRlckdyaWQoZGF0YVVybCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlck9yZGVyR3JpZCh1cmwpIHtcclxuXHJcbiAgY29uc3QgZ3JpZCA9ICQoXCIjZ3JpZFwiKS5kYXRhKFwia2VuZG9HcmlkXCIpO1xyXG4gIGlmIChncmlkICE9PSB1bmRlZmluZWQgJiYgZ3JpZCAhPT0gbnVsbCkge1xyXG4gICAgZ3JpZC5kYXRhU291cmNlLnJlYWQoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgJChcIiNncmlkXCIpLmtlbmRvR3JpZCh7XHJcbiAgICAgIGRhdGFTb3VyY2U6IHtcclxuICAgICAgICB0eXBlOiBcImpzb25cIixcclxuICAgICAgICB0cmFuc3BvcnQ6IHtcclxuICAgICAgICAgIHJlYWQob3B0aW9ucykge1xyXG4gICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KCQoXCIjc3RhcnRcIikudmFsKCkpLnV0YygpLmZvcm1hdChcIllZWVktTU0tRERcIiksXHJcbiAgICAgICAgICAgICAgICBlbmREYXRlOiBtb21lbnQoJChcIiNlbmRcIikudmFsKCkpLmFkZCgxLCBcImRheXNcIikudXRjKCkuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKVxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgc3VjY2VzcyhyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIG9wdGlvbnMuc3VjY2VzcyhyZXN1bHQpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgY2FjaGU6IGZhbHNlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYWdlU2l6ZTogMjAsXHJcbiAgICAgICAgc2NoZW1hOiB7XHJcbiAgICAgICAgICB0eXBlOiBcImpzb25cIixcclxuICAgICAgICAgIGRhdGE6IFwiRGF0YVwiLFxyXG4gICAgICAgICAgdG90YWwocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLkRhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2hhbmdlOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmRhdGEoKS5sZW5ndGggPD0gMCkge1xyXG4gICAgICAgICAgICAkKFwiI25vLW9yZGVycy1tZXNzYWdlXCIpLnNob3coKTtcclxuICAgICAgICAgICAgJChcIiNncmlkXCIpLmhpZGUoKTtcclxuICAgICAgICAgICAgJChcIiNkYXRhU2VjdXJpdHlEaXNjbGFpbWVyXCIpLmhpZGUoKTtcclxuICAgICAgICAgICAgJChcIiNwYWdlclwiKS5oaWRlKCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAkKFwiI25vLW9yZGVycy1tZXNzYWdlXCIpLmhpZGUoKTtcclxuICAgICAgICAgICAgJChcIiNncmlkXCIpLnNob3coKTtcclxuICAgICAgICAgICAgJChcIiNkYXRhU2VjdXJpdHlEaXNjbGFpbWVyXCIpLnNob3coKTtcclxuICAgICAgICAgICAgJChcIiNwYWdlclwiKS5zaG93KCk7XHJcbiAgICAgICAgICAgICQoXCIjd2FybmluZ1wiKS5oaWRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBzY3JvbGxhYmxlOiBmYWxzZSxcclxuICAgICAgZmlsdGVyYWJsZTogZmFsc2UsXHJcbiAgICAgIHBhZ2VhYmxlOiB7XHJcbiAgICAgICAgICBwYWdlU2l6ZTogMTAsXHJcbiAgICAgICAgICBwYWdlU2l6ZXM6IGZhbHNlLFxyXG4gICAgICB9LFxyXG4gICAgICBjb2x1bW5zOiBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgZmllbGQ6IFwiTmFtZVwiLFxyXG4gICAgICAgICAgdGl0bGU6IFwiTGlzdCBOYW1lL1NvdXJjZVwiLFxyXG4gICAgICAgICAgYXR0cmlidXRlczogeyBzdHlsZTogXCJ0ZXh0LWFsaWduOiBjZW50ZXI7XCIgfSxcclxuICAgICAgICAgICAgICB0ZW1wbGF0ZToga2VuZG8udGVtcGxhdGUoJChcIiNncmlkLWRlc2NyaXB0aW9uLWNvbHVtbi10ZW1wbGF0ZVwiKS5odG1sKCkpLFxyXG4gICAgICAgICAgbWVkaWE6IFwiKG1pbi13aWR0aDogNDUwcHgpXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGZpZWxkOiBcIkRhdGVTdWJtaXR0ZWRcIixcclxuICAgICAgICAgIHRpdGxlOiBcIk9yZGVyIERhdGVcIixcclxuICAgICAgICAgIGF0dHJpYnV0ZXM6IHsgc3R5bGU6IFwidGV4dC1hbGlnbjogY2VudGVyO1wiIH0sXHJcbiAgICAgICAgICB3aWR0aDogMjAwLFxyXG4gICAgICAgICAgdGVtcGxhdGU6IFwiIz0ga2VuZG8udG9TdHJpbmcoa2VuZG8ucGFyc2VEYXRlKERhdGVTdWJtaXR0ZWQsICdNTS9kZC95eXl5JyksICdNTS9kZC95eXl5JykgI1wiLFxyXG4gICAgICAgICAgbWVkaWE6IFwiKG1pbi13aWR0aDogNDUwcHgpXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGZpZWxkOiBcIlNvdXJjZURlc2NyaXB0aW9uXCIsXHJcbiAgICAgICAgICB0aXRsZTogXCJTdWJtaXR0ZWQgVGhyb3VnaFwiLFxyXG4gICAgICAgICAgYXR0cmlidXRlczogeyBzdHlsZTogXCJ0ZXh0LWFsaWduOiBjZW50ZXI7XCIgfSxcclxuICAgICAgICAgIG1lZGlhOiBcIihtaW4td2lkdGg6IDQ1MHB4KVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICAvL3tcclxuICAgICAgICAvLyAgZmllbGQ6IFwiVG90YWxSZWNvcmRzXCIsXHJcbiAgICAgICAgLy8gIHRpdGxlOiBcIlJlY29yZCBDb3VudFwiLFxyXG4gICAgICAgIC8vICBhdHRyaWJ1dGVzOiB7IHN0eWxlOiBcInRleHQtYWxpZ246IGNlbnRlcjtcIiB9LFxyXG4gICAgICAgIC8vICBmb3JtYXQ6IFwiezA6bjB9XCIsXHJcbiAgICAgICAgLy8gIG1lZGlhOiBcIihtaW4td2lkdGg6IDQ1MHB4KVwiXHJcbiAgICAgICAgLy99LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGZpZWxkOiBcIlN0YXR1c0Rlc2NyaXB0aW9uXCIsXHJcbiAgICAgICAgICB0aXRsZTogXCJTdGF0dXNcIixcclxuICAgICAgICAgIHdpZHRoOiAyMDAsXHJcbiAgICAgICAgICBhdHRyaWJ1dGVzOiB7IHN0eWxlOiBcInRleHQtYWxpZ246IGNlbnRlcjsgd2hpdGUtc3BhY2U6IG5vd3JhcFwiIH0sXHJcbiAgICAgICAgICB0ZW1wbGF0ZToga2VuZG8udGVtcGxhdGUoJChcIiNncmlkLXN0YXR1cy1jb2x1bW4tdGVtcGxhdGVcIikuaHRtbCgpKSxcclxuICAgICAgICAgIG1lZGlhOiBcIihtaW4td2lkdGg6IDQ1MHB4KVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB0aXRsZTogXCJTdW1tYXJ5XCIsXHJcbiAgICAgICAgICB0ZW1wbGF0ZToga2VuZG8udGVtcGxhdGUoJChcIiNyZXNwb25zaXZlLWNvbHVtbi10ZW1wbGF0ZVwiKS5odG1sKCkpLFxyXG4gICAgICAgICAgbWVkaWE6IFwiKG1heC13aWR0aDogNDUwcHgpXCJcclxuICAgICAgICB9XHJcbiAgICAgIF1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGxheURvd25sb2FkQ29uZmlybWF0aW9uKGRvd25sb2FkVXJsLCBjdXN0b21lckZpbGVOYW1lLCBzbHVnLCBzdGF0dXMpIHtcclxuICBzd2l0Y2ggKHN0YXR1cykge1xyXG4gIGNhc2UgXCJVcGxvYWRpbmdcIjpcclxuICAgIGlmIChzbHVnKVxyXG4gICAgICAkKFwiI2Rvd25sb2FkQ29uZmlybWF0aW9uIC5tb2RhbC1ib2R5IHBcIikudGV4dChcclxuICAgICAgICBgVGhlIHJlc3VsdHMgZm9yICR7Y3VzdG9tZXJGaWxlTmFtZX0gYXJlIGN1cnJlbnRseSBiZWluZyB1cGxvYWRlZCB0byAke3NsdWdcclxuICAgICAgICB9LiBUaGlzIGZpbGUgaXMgZm9yIHJlZmVyZW5jZSBvbmx5IGFuZCBzaG91bGQgbm90IGJlIGltcG9ydGVkIGludG8geW91ciBuYXRpb24uYCk7XHJcbiAgICBicmVhaztcclxuICBjYXNlIFwiQ29tcGxldGVcIjpcclxuICAgICQoXCIjZG93bmxvYWRDb25maXJtYXRpb24gLm1vZGFsLWJvZHkgcFwiKS50ZXh0KGBUaGUgcmVzdWx0cyBmb3IgJHtjdXN0b21lckZpbGVOYW1lfSBoYXZlIGJlZW4gdXBsb2FkZWQgdG8gJHtzbHVnXHJcbiAgICAgIH0uIFRoaXMgZmlsZSBpcyBmb3IgcmVmZXJlbmNlIG9ubHkgYW5kIHNob3VsZCBub3QgYmUgaW1wb3J0ZWQgaW50byB5b3VyIG5hdGlvbi5gKTtcclxuICAgIGJyZWFrO1xyXG4gIH1cclxuICB0aGlzLmlkID0gZG93bmxvYWRVcmw7XHJcbiAgJChcIiNkb3dubG9hZENvbmZpcm1hdGlvblwiKS5tb2RhbChcInNob3dcIik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRvd25sb2FkUHVzaE91dHB1dEZpbGUoKSB7XHJcbiAgJChcIiNkb3dubG9hZENvbmZpcm1hdGlvblwiKS5tb2RhbChcImhpZGVcIik7XHJcbiAgaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgXCJPcmRlcnNcIiwgXCIvT3JkZXIvQ3VycmVudFwiKTtcclxuICB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShgJHtpZH1gKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZG93bmxvYWRGaWxlKHVybCkge1xyXG4gIGhpc3RvcnkucHVzaFN0YXRlKG51bGwsIFwiT3JkZXJzXCIsIFwiL09yZGVyL0N1cnJlbnRcIik7XHJcbiAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UodXJsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZG93bmxvYWRVc2FnZSgpIHtcclxuICAkKFwiI2Rvd25sb2FkVXNhZ2VNb2RhbFwiKS5tb2RhbChcImhpZGVcIik7XHJcbiAgd2luZG93LmxvY2F0aW9uLnJlcGxhY2UoXHJcbiAgICBgL09yZGVyL0Rvd25sb2FkVXNhZ2U/c3RhcnQ9JHttb21lbnQoJChcIiN1c2FnZURhdGVSYW5nZVdpZGdldF9zdGFydERhdGVcIikudmFsKCkpLmZvcm1hdChcIllZWVktTU0tRERcIilcclxuICAgIH0mZW5kPSR7bW9tZW50KCQoXCIjdXNhZ2VEYXRlUmFuZ2VXaWRnZXRfZW5kRGF0ZVwiKS52YWwoKSkuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKX1gKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGxheU1lc3NhZ2UodHlwZSwgbWVzc2FnZSkge1xyXG4gIGNvbnN0IGFsZXJ0ID0gJChcIiNhbGVydFwiKTtcclxuICBzd2l0Y2ggKHR5cGUpIHtcclxuICBjYXNlIFwic3VjY2Vzc1wiOlxyXG4gICAgYWxlcnQuYWRkQ2xhc3MoXCJhbGVydFwiKS5hZGRDbGFzcyhcImFsZXJ0LXN1Y2Nlc3NcIik7XHJcbiAgICBhbGVydC50ZXh0KG1lc3NhZ2UpO1xyXG4gICAgYWxlcnQuc2hvdygpO1xyXG4gICAgYnJlYWs7XHJcbiAgY2FzZSBcImluZm9cIjpcclxuICAgIGFsZXJ0LmFkZENsYXNzKFwiYWxlcnRcIikuYWRkQ2xhc3MoXCJhbGVydC1pbmZvXCIpO1xyXG4gICAgYWxlcnQudGV4dChtZXNzYWdlKTtcclxuICAgIGFsZXJ0LnNob3coKTtcclxuICAgIGJyZWFrO1xyXG4gIGNhc2UgXCJ3YXJuaW5nXCI6XHJcbiAgICBhbGVydC5hZGRDbGFzcyhcImFsZXJ0XCIpLmFkZENsYXNzKFwiYWxlcnQtd2FybmluZ1wiKTtcclxuICAgIGFsZXJ0LnRleHQobWVzc2FnZSk7XHJcbiAgICBhbGVydC5zaG93KCk7XHJcbiAgICBicmVhaztcclxuICBjYXNlIFwiZGFuZ2VyXCI6XHJcbiAgICBhbGVydC5hZGRDbGFzcyhcImFsZXJ0XCIpLmFkZENsYXNzKFwiYWxlcnQtZGFuZ2VyXCIpO1xyXG4gICAgYWxlcnQudGV4dChtZXNzYWdlKTtcclxuICAgIGFsZXJ0LnNob3coKTtcclxuICAgIGJyZWFrO1xyXG4gIGRlZmF1bHQ6XHJcbiAgICBhbGVydC5yZW1vdmVDbGFzcygpO1xyXG4gICAgYWxlcnQuaGlkZSgpO1xyXG4gICAgYnJlYWs7XHJcbiAgfVxyXG59Il19